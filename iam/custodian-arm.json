{
    "properties": {
        "roleName": "Custodian",
        "description": "Custom role is cover all Custodian rules to run with with minimal permissions. Requires RBAC permissions model for Azure Key Vault",
        "assignableScopes": [
            "/subscriptions/{subscription_id}"
        ],
        "permissions": [
            {
                "actions": [
                    "Microsoft.ApiManagement/service/read",
                    "Microsoft.ApiManagement/service/certificates/read",
                    "Microsoft.AppConfiguration/configurationStores/read",
                    "Microsoft.AppPlatform/Spring/read",
                    "Microsoft.Authorization/policyAssignments/read",
                    "Microsoft.Authorization/policyDefinitions/read",
                    "Microsoft.Authorization/policySetDefinitions/read",
                    "Microsoft.Automation/automationAccounts/read",
                    "Microsoft.Automation/automationAccounts/variables/read",
                    "Microsoft.Batch/batchAccounts/read",
                    "Microsoft.Batch/batchAccounts/providers/Microsoft.Insights/diagnosticSettings/read",
                    "Microsoft.Cache/redis/read",
                    "Microsoft.Cache/redis/firewallRules/read",
                    "Microsoft.CognitiveServices/accounts/read",
                    "Microsoft.Compute/disks/read",
                    "Microsoft.Compute/snapshots/read",
                    "Microsoft.Compute/virtualMachines/read",
                    "Microsoft.Compute/virtualMachines/extensions/read",
                    "Microsoft.Compute/virtualMachineScaleSets/read",
                    "Microsoft.Compute/virtualMachineScaleSets/providers/Microsoft.Insights/diagnosticSettings/read",
                    "Microsoft.ContainerService/managedClusters/read",
                    "Microsoft.ContainerService/managedClusters/providers/Microsoft.Insights/diagnosticSettings/read",
                    "Microsoft.ContainerRegistry/registries/read",
                    "Microsoft.DataFactory/factories/read",
                    "Microsoft.Databricks/workspaces/read",
                    "Microsoft.DataLakeAnalytics/accounts/read",
                    "Microsoft.DataLakeAnalytics/accounts/providers/Microsoft.Insights/diagnosticSettings/read",
                    "Microsoft.DataLakeStore/accounts/read",
                    "Microsoft.DataLakeStore/accounts/providers/Microsoft.Insights/diagnosticSettings/read",
                    "Microsoft.DBforPostgreSQL/servers/read",
                    "Microsoft.DBforPostgreSQL/servers/configurations/read",
                    "Microsoft.DBforPostgreSQL/servers/securityAlertPolicies/read",
                    "Microsoft.DBforMySQL/servers/read",
                    "Microsoft.DBforMySQL/servers/configurations/read",
                    "Microsoft.DBforMySQL/servers/securityAlertPolicies/read",
                    "Microsoft.DBforMariaDB/servers/read",
                    "Microsoft.Devices/iotHubs/Read",
                    "Microsoft.Devices/IotHubs/diagnosticSettings/read",
                    "Microsoft.DocumentDB/databaseAccounts/read",
                    "Microsoft.EventGrid/domains/read",
                    "Microsoft.EventGrid/topics/read",
                    "Microsoft.EventHub/namespaces/read",
                    "Microsoft.EventHub/namespaces/privateEndpointConnections/read",
                    "Microsoft.EventHub/namespaces/providers/Microsoft.Insights/diagnosticSettings/read",
                    "Microsoft.Insights/ActivityLogAlerts/Read",
                    "Microsoft.Insights/DiagnosticSettings/Read",
                    "Microsoft.KeyVault/vaults/read",
                    "Microsoft.KeyVault/vaults/providers/Microsoft.Insights/diagnosticSettings/Read",
                    "Microsoft.Logic/workflows/read",
                    "Microsoft.Logic/workflows/providers/Microsoft.Insights/diagnosticSettings/read",
                    "Microsoft.Insights/Logs/Read",
                    "Microsoft.Insights/LogProfiles/Read",
                    "Microsoft.Kusto/Clusters/read",
                    "Microsoft.MachineLearning/Workspaces/read",
                    "Microsoft.MachineLearningServices/workspaces/read",
                    "Microsoft.MachineLearningServices/workspaces/computes/read",
                    "Microsoft.Network/networkSecurityGroups/read",
                    "Microsoft.Network/frontDoors/read",
                    "Microsoft.Network/frontDoorWebApplicationFirewallPolicies/read",
                    "Microsoft.Network/frontDoorWebApplicationFirewallManagedRuleSets/read",
                    "Microsoft.Network/applicationGateways/read",
                    "Microsoft.Network/networkInterfaces/read",
                    "Microsoft.Network/networkWatchers/read",
                    "Microsoft.Network/networkWatchers/flowLogs/read",
                    "Microsoft.Network/virtualNetworks/read",
                    "Microsoft.RecoveryServices/Locations/backupStatus/action",
                    "Microsoft.Resources/subscriptions/read",
                    "Microsoft.Search/searchServices/read",
                    "Microsoft.Search/searchServices/diagnosticSettings/read",
                    "Microsoft.Security/assessments/read",
                    "Microsoft.Security/autoProvisioningSettings/read",
                    "Microsoft.Security/locations/jitNetworkAccessPolicies/read",
                    "Microsoft.Security/securityContacts/read",
                    "Microsoft.Security/settings/read",
                    "Microsoft.Security/pricings/read",
                    "Microsoft.ServiceBus/namespaces/read",
                    "Microsoft.ServiceBus/namespaces/providers/Microsoft.Insights/diagnosticSettings/read",
                    "Microsoft.ServiceFabric/clusters/read",
                    "Microsoft.SignalRService/SignalR/read",
                    "Microsoft.Storage/storageAccounts/read",
                    "Microsoft.Storage/storageAccounts/listkeys/action",
                    "Microsoft.Storage/storageAccounts/blobServices/read",
                    "Microsoft.Storage/storageAccounts/blobServices/containers/read",
                    "Microsoft.Storage/storageAccounts/blobServices/providers/Microsoft.Insights/diagnosticSettings/read",
                    "Microsoft.Storage/storageAccounts/tableServices/read",
                    "Microsoft.Storage/storageAccounts/tableServices/tables/read",
                    "Microsoft.Storage/storageAccounts/tableServices/providers/Microsoft.Insights/diagnosticSettings/read",
                    "Microsoft.Storage/storageAccounts/queueServices/read",
                    "Microsoft.Storage/storageAccounts/queueServices/queues/read",
                    "Microsoft.Storage/storageAccounts/queueServices/providers/Microsoft.Insights/diagnosticSettings/read",
                    "Microsoft.StreamAnalytics/streamingjobs/Read",
                    "Microsoft.StreamAnalytics/streamingjobs/providers/Microsoft.Insights/diagnosticSettings/read",
                    "Microsoft.Sql/locations/instanceFailoverGroups/read",
                    "Microsoft.Sql/managedInstances/read",
                    "Microsoft.Sql/managedInstances/encryptionProtector/read",
                    "Microsoft.Sql/managedInstances/securityAlertPolicies/read",
                    "Microsoft.Sql/managedInstances/vulnerabilityAssessments/read",
                    "Microsoft.Sql/servers/read",
                    "Microsoft.Sql/servers/auditingSettings/read",
                    "Microsoft.Sql/servers/encryptionProtector/read",
                    "Microsoft.Sql/servers/firewallRules/read",
                    "Microsoft.Sql/servers/databases/read",
                    "Microsoft.Sql/servers/databases/transparentDataEncryption/read",
                    "Microsoft.Sql/servers/securityAlertPolicies/read",
                    "Microsoft.Sql/servers/vulnerabilityAssessments/read",
                    "Microsoft.Synapse/workspaces/read",
                    "Microsoft.Web/sites/Read",
                    "Microsoft.Web/sites/config/Read",
                    "Microsoft.Web/sites/config/list/Action",
                    "microsoft.web/sites/providers/Microsoft.Insights/diagnosticSettings/read"
                ],
                "notActions": [],
                "dataActions": [
                    "Microsoft.KeyVault/vaults/keys/read",
                    "Microsoft.KeyVault/vaults/secrets/readMetadata/action"
                ],
                "notDataActions": []
            }
        ]
    }
}